version: 2

models:
  - name: dim_cows
    description: "Master list of all 1,000 cows in the dairy project."
    columns:
      - name: cow_id
        tests:
          - unique
          - not_null

  - name: fct_daily_yields
    description: "Incremental table of daily milk production and feed intake."
    columns:
      - name: production_id
        tests:
          - unique
          - not_null
      - name: cow_id
        tests:
          - not_null
          - relationships:
              to: ref('dim_cows')
              field: cow_id
      - name: milk_yield_liters
        description: "Daily milk produced in liters. Standard range is 0 to 100."
        tests:
          # This replaces accepted_values and will now pass for all numbers in range
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100